CREATE OR REPLACE VIEW ASSTABPRECOUSUARIO AS
SELECT
	t."IDTABPRECOERP",
	us."IDUSUARIOERP"
FROM
	OPLN c
	INNER JOIN TABPRECO t on(c."ListNum" = t."IDTABPRECOERP")
	INNER JOIN "@LIBERAPARA" l on(l."Code" = c."U_tipoComissao")
	INNER JOIN "ASSUSUARIOEMPRESA" us on(us."IDEMPRESAERP" = l."U_Filial")
UNION
SELECT
	t."IDTABPRECOERP",
	u."IDUSUARIOERP"
FROM
	OPLN c
	INNER JOIN TABPRECO t on(c."ListNum" = t."IDTABPRECOERP")
	INNER JOIN "@LIBERAPARA" l on(l."Code" = c."U_tipoComissao")
	INNER JOIN "USUARIO" u on(u."IDUSUARIOERP" = l."U_vendedor")